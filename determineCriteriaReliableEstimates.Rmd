---
title: "Analysis of data requirements"
author: "Annelinde Lettink"
date: "10/9/2023"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
## User settings
# Directory path and name of castor export file
filepath.castor <- "/Users/annelindelettink/Documents/Work MacBook Pro Annelinde/My Little Moves (MLM)/Castor export"
filename.castor <- "/20231007/Study/My_Little_Moves_export_20231007.csv"
# Directory path and name of app data (frequency and duration per day)
filepath.app <- "/Users/annelindelettink/Documents/Work MacBook Pro Annelinde/My Little Moves (MLM)/App-data/20230918"
filename.app <- "/20230918_MLMapp_activiteit_gedrag_duur_per_dag.csv"
# Directory path for epochdata hip and wrist
epochdir.hip <- "/Users/annelindelettink/Documents/Work MacBook Pro Annelinde/My Little Moves (MLM)/Accelerometer data/Measurement1/5sec/epochdata/hip/nonwear_removed"
epochdir.wrist <- "/Users/annelindelettink/Documents/Work MacBook Pro Annelinde/My Little Moves (MLM)/Accelerometer data/Measurement1/5sec/epochdata/wrist/nonwear_removed"

# source functions directly from file, to be replaced by package installation:
my_functions_folder =   "/Users/annelindelettink/Documents/Work MacBook Pro Annelinde/My Little Moves (MLM)/Comparison MLM-app and accelerometer data/Analyses/AxivityMLMapp/R"
for (function_file in dir(my_functions_folder, full.names = T)) source(function_file) #load functions

# Load in Castor data (this file includes participant characteristics)
data.castor <- load.castor(filepath.castor, filename.castor, cohort = c(3))
```

## Determine criteria for generation of reliable estimates

In this script, the 6-step process is applied as method to derive sample-specific valid day criterion for both the MLM app and Axivity (hip and wrist) data (Bingham et al., 2016)

# Step 1: Determine minimum wear-time

```{r Step 1 Axivity, echo=FALSE}
# Number of accelerometer files at start
filelist.hip <- list.files(epochdir.hip, pattern = ".RData")
filelist.wrist <- list.files(epochdir.wrist, pattern = ".RData")
paste0("accelerometer files hip: ", length(filelist.hip))
paste0("accelerometer files wrist: ", length(filelist.wrist))

# Select files that provide => 8 hours on one day
savedir.hip <- paste0(epochdir.hip, "/1d8h")
validday.axivity(epochdir.hip, epochlength = 5, minhours = 8, mindays = 1, savedir = savedir.hip, data.castor) 
savedir.wrist <- paste0(epochdir.wrist, "/1d8h")
validday.axivity(epochdir.wrist, epochlength = 5, minhours = 8, mindays = 1, savedir = savedir.wrist, data.castor)
paste0("hip: accelerometer files that provide at least 8 h on one day: ", length(list.files(savedir.hip, pattern = ".RData")), "(", length(list.files(savedir.hip, pattern = ".RData"))/length(filelist.hip)*100, " %)")
paste0("wrist: accelerometer files that provide at least 8 h on one day: ", length(list.files(savedir.wrist, pattern = ".RData")), "(", length(list.files(savedir.wrist, pattern = ".RData"))/length(filelist.wrist)*100, " %)")

# Apply the 70/80 rule
weartime.hip <- apply.7080rule(savedir.hip, method = "axivity")
paste0("minimum required wear time hip: ", weartime.hip, " min (", weartime.hip/60, " h)")
weartime.wrist <- apply.7080rule(savedir.wrist, method = "axivity")
paste0("minimum required wear time wrist: ", weartime.wrist, " min (", weartime.wrist/60, " h)")
```

```{r Step 1 MLM app, echo=FALSE}
## Step 1: Determine the length of one day of data
# Load app data for all cohorts
data.app <- load.app(filepath.app, filename.app, cohort = c(1,2,3), measurementperiod = 1, sep = ";")

# Number of participants at start
paste0("number of participants: ", length(unique(data.app$castorID)))

# Select files that provide => 8 hours on one day
valid_data_8h1d <- validday.app(data.app, minhours = 8, mindays = 1, savedir = filepath.app) 
paste0("participants provide at least 8 h on one day: ", length(unique(valid_data_8h1d$castorID)), "(", length(unique(valid_data_8h1d$castorID))/length(unique(data.app$castorID))*100, " %)")

# Apply the 70/80 rule
minimumtime <- apply.7080rule(method = "app", data.app = valid_data_8h1d)
paste0("minimum time app: ", minimumtime, " min (", minimumtime/60, " h)")
```

# Step 2: Process 7-day-data

```{r Step 2 Axivity, echo=FALSE}
savedir.hip <- paste0(epochdir.hip, "/7d18h")
validday.axivity(epochdir = epochdir.hip, epochlength = 5, minhours = 18, mindays = 7, savedir = savedir.hip, data.castor, analysis = "reliability")
paste0("hip: accelerometer files that provide 7 days of at least 18 h: ", length(list.files(savedir.hip, pattern = ".RData")), "(", length(list.files(savedir.hip, pattern = ".RData"))/length(list.files(paste0(epochdir.hip, "/1d8h"), pattern = ".RData"))*100," %)")

savedir.wrist <- paste0(epochdir.wrist, "/7d18h")
validday.axivity(epochdir = epochdir.wrist, epochlength = 5, minhours = 18, mindays = 7, savedir = savedir.wrist, data.castor, analysis = "reliability") 
paste0("wrist: accelerometer files that provide 7 days of at least 18 h: ", length(list.files(savedir.wrist, pattern = ".RData")), "(", length(list.files(savedir.wrist, pattern = ".RData"))/length(list.files(paste0(epochdir.wrist, "/1d8h"), pattern = ".RData"))*100," %)")

## Generate the outcomes per accelerometer recording (per day)
axivity.estimates.hip <- estimates.axivity(savedir.hip) 
axivity.estimates.wrist <- estimates.axivity(savedir.wrist)

axivity.estimates.both <- merge(axivity.estimates.hip, axivity.estimates.wrist, by = c("id", "date"))
axivity.estimates.both$ENMO.both <- axivity.estimates.both$ENMO.x * axivity.estimates.both$ENMO.y
axivity.estimates.both$MAD.both <- axivity.estimates.both$MAD.x * axivity.estimates.both$MAD.y
axivity.estimates.both$ENMOig.both <- axivity.estimates.both$ig_ENMO.x * axivity.estimates.both$ig_ENMO.y
axivity.estimates.both$MADig.both <- axivity.estimates.both$ig_MAD.x * axivity.estimates.both$ig_MAD.y
```

```{r Step 2 Axivity estimates per milestone group, echo=FALSE}
# Generate per milestone group (no crawl, crawl and walk) as it is expected that the accelerometers record different accelerations

milestones <- load.app(filepath.app, "/20230918_motormilestones_castor_linked.csv", cohort = c(3), measurementperiod = 1, sep = ",") # Load milestone data

# Generate milestone indicators for hip and wrist
pp.hip <- unique(axivity.estimates.hip$id)
pp.wrist <- unique(axivity.estimates.wrist$id)
pp <- pp.hip
crawl <- c()
walk <- c()
counter = 1
for(subj in 1:(length(pp.hip)+length(pp.wrist))) { # For each subject
  tmp <- milestones[milestones$castorID==pp[counter],] # Select the milestone data
  if(tmp$age.group == 5 || tmp$age.group== 4){ #if child is 2-4 years old, assume ability to crawl and walk
    crawl <- c(crawl, 1)
    walk <- c(walk, 1)
  } else if(tmp$age.group == 1) { # It the child is 0-6 months, assume the child cannot walk and ask whether the child can crawl
    walk <- c(walk, 0)
    if(tmp$crawl == 1){
      crawl <- c(crawl, 1)
    } else {crawl <- c(crawl, 0)}  } 
  else { # For children between 6 and 24 months ask if child is able to crawl and/or walk
    if(tmp$crawl == 1){
      crawl <- c(crawl, 1)
    } else {crawl <- c(crawl, 0)}
    if(tmp$walk == 1){
      walk <- c(walk, 1)
    } else {walk <- c(walk, 0)}
  }
  counter = counter + 1
  if(subj == length(pp.hip)){
    tmp.hip <- as.data.frame(cbind(pp, crawl, walk))
    pp <- pp.wrist
    crawl <- c()
    walk <- c()
    counter = 1
  }
}
tmp.wrist <- as.data.frame(cbind(pp, crawl, walk))

R.nocrawl.hip <- tmp.hip$pp[which(tmp.hip$crawl == 0 & tmp.hip$walk == 0)]
R.crawl.hip <- tmp.hip$pp[which(tmp.hip$crawl == 1 & tmp.hip$walk == 0)]
R.walk.hip <- tmp.hip$pp[which(tmp.hip$crawl == 1 & tmp.hip$walk == 1)]
R.nocrawl.wrist <- tmp.wrist$pp[which(tmp.wrist$crawl == 0 & tmp.wrist$walk == 0)]
R.crawl.wrist <- tmp.wrist$pp[which(tmp.wrist$crawl == 1 & tmp.wrist$walk == 0)]
R.walk.wrist <- tmp.wrist$pp[which(tmp.wrist$crawl == 1 & tmp.wrist$walk == 1)]

# Estimates per milestone
# Hip
estimates.nocrawl.hip <- subset(axivity.estimates.hip, subset=axivity.estimates.hip$id %in% R.nocrawl.hip) 
print("Hip: ", length(unique(unique(estimates.nocrawl.hip$id))), " children do not crawl yet")
estimates.crawl.hip <- subset(axivity.estimates.hip, subset=axivity.estimates.hip$id %in% R.crawl.hip) 
print("Hip: ", length(unique(unique(estimates.crawl.hip$id))), " children can crawl but not walk")
estimates.walk.hip <- subset(axivity.estimates.hip, subset=axivity.estimates.hip$id %in% R.walk.hip) 
print("Hip: ", length(unique(unique(estimates.walk.hip$id))), " children can walk")

#Wrist
estimates.nocrawl.wrist <- subset(axivity.estimates.wrist, subset=axivity.estimates.wrist$id %in% R.nocrawl.wrist)
print("Wrist: ", length(unique(unique(estimates.nocrawl.wrist$id))), " children do not crawl yet")
estimates.crawl.wrist <- subset(axivity.estimates.wrist, subset=axivity.estimates.wrist$id %in% R.crawl.wrist) 
print("Wrist: ", length(unique(unique(estimates.crawl.wrist$id))), " children can crawl but not walk")
estimates.walk.wrist <- subset(axivity.estimates.wrist, subset=axivity.estimates.wrist$id %in% R.walk.wrist) 
print("Wrist: ", length(unique(unique(estimates.walk.wrist$id))), " children can walk")

#Both
estimates.nocrawl.both <- merge(estimates.nocrawl.hip, estimates.nocrawl.wrist, by = c("id", "date", "days", "weekday")) # Merge the estimate date.frames for hip and wrist, then calculate the metrics
estimates.nocrawl.both$ENMO.both <- estimates.nocrawl.both$ENMO.x * estimates.nocrawl.both$ENMO.y
estimates.nocrawl.both$ig_ENMO.both <- estimates.nocrawl.both$ig_ENMO.x * estimates.nocrawl.both$ig_ENMO.y
estimates.nocrawl.both$MAD.both <- estimates.nocrawl.both$MAD.x * estimates.nocrawl.both$MAD.y
estimates.nocrawl.both$ig_MAD.both <- estimates.nocrawl.both$ig_MAD.x * estimates.nocrawl.both$ig_MAD.y
print("Hip * Wrist: ", length(unique(unique(estimates.nocrawl.both$id))), " children do not crawl yet")

estimates.crawl.both <- merge(estimates.crawl.hip, estimates.crawl.wrist, by = c("id", "date", "days", "weekday"))
# Merge the estimate date.frames for hip and wrist, then calculate the metrics
estimates.crawl.both$ENMO.both <- estimates.crawl.both$ENMO.x * estimates.crawl.both$ENMO.y
estimates.crawl.both$ig_ENMO.both <- estimates.crawl.both$ig_ENMO.x * estimates.crawl.both$ig_ENMO.y
estimates.crawl.both$MAD.both <- estimates.crawl.both$MAD.x * estimates.crawl.both$MAD.y
estimates.crawl.both$ig_MAD.both <- estimates.crawl.both$ig_MAD.x * estimates.crawl.both$ig_MAD.y
print("Hip * Wrist: ", length(unique(unique(estimates.crawl.both$id))), " children can crawl but not walk")

estimates.walk.both <- merge(estimates.walk.hip, estimates.walk.wrist, by = c("id", "date", "days", "weekday")) # Merge the estimate date.frames for hip and wrist, then calculate the metrics
estimates.walk.both$ENMO.both <- estimates.walk.both$ENMO.x * estimates.walk.both$ENMO.y
estimates.walk.both$ig_ENMO.both <- estimates.walk.both$ig_ENMO.x * estimates.walk.both$ig_ENMO.y
estimates.walk.both$MAD.both <- estimates.walk.both$MAD.x * estimates.walk.both$MAD.y
estimates.walk.both$ig_MAD.both <- estimates.walk.both$ig_MAD.x * estimates.walk.both$ig_MAD.y
print("Hip * Wrist: ", length(unique(unique(estimates.walk.both$id))), " children can walk")


rm(tmp, R.nocrawl.hip, R.crawl.hip, R.walk.hip, tmp.hip, R.nocrawl.wrist, R.crawl.wrist, R.walk.wrist, tmp.wrist, milestones, counter, crawl, walk, pp, pp.hip, pp.wrist, subj)
```

```{r Step 2 MLM app, echo=FALSE}
valid_data_16h7d <- validday.app(data.app, minhours = 16, mindays = 7, savedir = filepath.app) 
paste0("participants provide at least 16 h on 7 day: ", length(unique(valid_data_16h7d$castorID)), "(", length(unique(valid_data_16h7d$castorID))/length(unique(valid_data_8h1d$castorID))*100, " %)")

# Apply the 70/80 rule
minimumtime <- apply.7080rule(method = "app", data.app = valid_data_8h1d)
paste0("minimum time app: ", minimumtime, " min (", minimumtime/60, " h)")
```

# Step 3: Determine the inclusion of a weekend day

```{r Step 3 Axivity, echo=FALSE}
library(dplyr)
desc.weekend.hip <- group_by(axivity.estimates.hip, weekday) %>% 
  summarise_at(c("ENMO", "ig_ENMO", 
                 "MAD", "ig_MAD"),
               list(median = median, IQR = quantile), na.rm = TRUE)
desc.weekend.hip[c(2,4,7,9),]

res_ENMO.hip <- wilcox.test(ENMO ~ weekday, data = axivity.estimates.hip, paired = FALSE)
z_ENMO.hip <- qnorm(res_ENMO.hip$p.value/2)
paste0("hip ENMO: Zscore =" ,z_ENMO.hip, ", p-value = ", res_ENMO.hip$p.value)
res_ig_ENMO.hip <- wilcox.test(ig_ENMO ~ weekday, data = axivity.estimates.hip, paired = FALSE)
z_ig_ENMO.hip <- qnorm(res_ig_ENMO.hip$p.value/2)
paste0("hip ENMO intensity gradient: Zscore =" ,z_ig_ENMO.hip, ", p-value = ", res_ig_ENMO.hip$p.value)
res_MAD.hip <- wilcox.test(MAD ~ weekday, data = axivity.estimates.hip, paired = FALSE)
z_MAD.hip <- qnorm(res_MAD.hip$p.value/2)
paste0("hip MAD: Zscore =" ,z_MAD.hip, ", p-value = ", res_MAD.hip$p.value)
res_ig_MAD.hip <- wilcox.test(ig_MAD ~ weekday, data = axivity.estimates.hip, paired = FALSE)
z_ig_MAD.hip <- qnorm(res_ig_MAD.hip$p.value/2)
paste0("hip MAD intensity gradient: Zscore =" ,z_ig_MAD.hip, ", p-value = ", res_ig_MAD.hip$p.value)

# Wrist
desc.weekend.wrist <- group_by(axivity.estimates.wrist, weekday) %>% 
  summarise_at(c("ENMO", "ig_ENMO", 
                 "MAD", "ig_MAD"),
               list(median = median, IQR = quantile), na.rm = TRUE)
desc.weekend.wrist[c(2,4,7,9),]

res_ENMO.wrist <- wilcox.test(ENMO ~ weekday, data = axivity.estimates.wrist, paired = FALSE)
z_ENMO.wrist <- qnorm(res_ENMO.wrist$p.value/2)
paste0("wrist ENMO: Zscore =" ,z_ENMO.wrist, ", p-value = ", res_ENMO.wrist$p.value)
res_ig_ENMO.wrist <- wilcox.test(ig_ENMO ~ weekday, data = axivity.estimates.wrist, paired = FALSE)
z_ig_ENMO.wrist <- qnorm(res_ig_ENMO.wrist$p.value/2)
paste0("wrist ENMO intensity gradient: Zscore =" ,z_ig_ENMO.wrist, ", p-value = ", res_ig_ENMO.wrist$p.value)
res_MAD.wrist <- wilcox.test(MAD ~ weekday, data = axivity.estimates.wrist, paired = FALSE)
z_MAD.wrist <- qnorm(res_MAD.wrist$p.value/2)
paste0("wrist MAD: Zscore =" ,z_MAD.wrist, ", p-value = ", res_MAD.wrist$p.value)
res_ig_MAD.wrist <- wilcox.test(ig_MAD ~ weekday, data = axivity.estimates.wrist, paired = FALSE)
z_ig_MAD.wrist <- qnorm(res_ig_MAD.wrist$p.value/2)
paste0("wrist MAD intensity gradient: Zscore =" ,z_ig_MAD.wrist, ", p-value = ", res_ig_MAD.wrist$p.value)

# Both
desc.weekend.both <- group_by(axivity.estimates.both, weekday.x) %>% 
  summarise_at(c("ENMO.both", "ENMOig.both", 
                 "MAD.both", "MADig.both"),
               list(median = median, IQR = quantile), na.rm = TRUE)
desc.weekend.both[c(2,4,7,9),]

res_ENMO.both <- wilcox.test(ENMO.both ~ weekday.x, data = axivity.estimates.both, paired = FALSE)
z_ENMO.both <- qnorm(res_ENMO.both$p.value/2)
paste0("hip*wrist ENMO: Zscore =" ,z_ENMO.both, ", p-value = ", res_ENMO.both$p.value)
res_ig_ENMO.both <- wilcox.test(ENMOig.both ~ weekday.x, data = axivity.estimates.both, paired = FALSE)
z_ig_ENMO.both <- qnorm(res_ig_ENMO.both$p.value/2)
paste0("hip*wrist ENMO intensity gradient: Zscore =" ,z_ig_ENMO.both, ", p-value = ", res_ig_ENMO.both$p.value)
res_MAD.both <- wilcox.test(MAD.both ~ weekday.x, data = axivity.estimates.both, paired = FALSE)
z_MAD.both <- qnorm(res_MAD.both$p.value/2)
paste0("hip*wrist MAD: Zscore =" ,z_MAD.both, ", p-value = ", res_MAD.both$p.value)
res_ig_MAD.both <- wilcox.test(MADig.both ~ weekday.x, data = axivity.estimates.both, paired = FALSE)
z_ig_MAD.both <- qnorm(res_ig_MAD.both$p.value/2)
paste0("hip*wrist ENMO intensity gradient: Zscore =" ,z_ig_MAD.both, ", p-value = ", res_ig_MAD.both$p.value)

rm(desc.weekend.hip, res_ENMO.hip, z_ENMO.hip, z_ig_ENMO.hip, res_MAD.hip, z_MAD.hip, res_ig_MAD.hip, z_ig_MAD.hip, desc.weekend.wrist, res_ENMO.wrist, z_ENMO.wrist, res_ig_ENMO.wrist, z_ig_ENMO.wrist, res_MAD.wrist, z_MAD.wrist, res_ig_MAD.wrist, z_ig_MAD.wrist, desc.weekend.both, res_ENMO.both, z_ENMO.both, res_ig_ENMO.both, z_ig_ENMO.both, res_MAD.both, z_MAD.both, res_ig_MAD.both)
```

```{r Step 3 MLM app, echo=FALSE}
## Step 3: Weekend day inclusion?
# Descriptives
library(dplyr)
desc.weekend.app <- group_by(valid_data_16h7d, weekenddag) %>% 
  summarise_at(c("PA", "SB", "sleep"),
               list(median = median, IQR = quantile), na.rm = TRUE)
desc.weekend.app[c(2,4,7,9),]
#Tests
res_PA <- wilcox.test(PA ~ weekenddag, data = valid_data_16h7d, paired = FALSE)
z_PA <- qnorm(res_PA$p.value/2)
paste0("PA: Zscore =" ,z_PA, ", p-value = ", res_PA$p.value)

res_SB <- wilcox.test(SB ~ weekenddag, data = valid_data_16h7d, paired = FALSE)
z_SB <- qnorm(res_SB$p.value/2)
paste0("SB: Zscore =" , z_SB, ", p-value = ", res_SB$p.value)

res_sleep <- wilcox.test(sleep ~ weekenddag, data = valid_data_16h7d, paired = FALSE)
z_sleep <- qnorm(res_sleep$p.value/2)
paste0("Sleep: Zscore =" , z_sleep, ", p-value = ", res_sleep$p.value)

rm(res_PA, z_PA, res_SB, z_SB, res_sleep, z_sleep)
```

# Step 4: Examine day-to-day variability

```{r Step 4 Axivity, echo=FALSE}
## Step 4: Day-to-day variability
# Hip
day_day_ENMO.hip <- friedman.test(y = axivity.estimates.hip$ENMO, groups = axivity.estimates.hip$days, blocks = axivity.estimates.hip$id)
paste0("Hip ENMO: Chi-square =" , day_day_ENMO.hip$statistic, ", p-value = ", day_day_ENMO.hip$p.value)
day_day_ig_ENMO.hip <- friedman.test(y = axivity.estimates.hip$ig_ENMO, groups = axivity.estimates.hip$days, blocks = axivity.estimates.hip$id)
paste0("Hip ENMO intensity gradient: Chi-square =" , day_day_ig_ENMO.hip$statistic, ", p-value = ", day_day_ig_ENMO.hip$p.value)
day_day_MAD.hip <- friedman.test(y = axivity.estimates.hip$MAD, groups = axivity.estimates.hip$days, blocks = axivity.estimates.hip$id)
paste0("Hip MAD: Chi-square =" , day_day_MAD.hip$statistic, ", p-value = ", day_day_MAD.hip$p.value)
day_day_ig_MAD.hip <- friedman.test(y = axivity.estimates.hip$ig_MAD, groups = axivity.estimates.hip$days, blocks = axivity.estimates.hip$id)
paste0("Hip MAD intensity gradient: Chi-square =" , day_day_ig_MAD.hip$statistic, ", p-value = ", day_day_ig_MAD.hip$p.value)

# Wrist
day_day_ENMO.wrist <- friedman.test(y = axivity.estimates.wrist$ENMO, groups = axivity.estimates.wrist$days, blocks = axivity.estimates.wrist$id)
paste0("Wrist ENMO: Chi-square =" , day_day_ENMO.wrist$statistic, ", p-value = ", day_day_ENMO.wrist$p.value)
day_day_ig_ENMO.wrist <- friedman.test(y = axivity.estimates.wrist$ig_ENMO, groups = axivity.estimates.wrist$days, blocks = axivity.estimates.wrist$id)
paste0("Wrist ENMO intensity gradient: Chi-square =" , day_day_ig_ENMO.wrist$statistic, ", p-value = ", day_day_ig_ENMO.wrist$p.value)
day_day_MAD.wrist <- friedman.test(y = axivity.estimates.wrist$MAD, groups = axivity.estimates.wrist$days, blocks = axivity.estimates.wrist$id)
paste0("Wrist MAD: Chi-square =" , day_day_MAD.wrist$statistic, ", p-value = ", day_day_MAD.wrist$p.value)
day_day_ig_MAD.wrist <- friedman.test(y = axivity.estimates.wrist$ig_MAD, groups = axivity.estimates.wrist$days, blocks = axivity.estimates.wrist$id)
paste0("Wrist MAD intensity gradient: Chi-square =" , day_day_ig_MAD.wrist$statistic, ", p-value = ", day_day_ig_MAD.wrist$p.value)

# Both
day_day_ENMO.both <- friedman.test(y = axivity.estimates.both$ENMO.both, groups = axivity.estimates.both$days.x, blocks = axivity.estimates.both$id)
paste0("Hip * Wrist ENMO: Chi-square =" , day_day_ENMO.both$statistic, ", p-value = ", day_day_ENMO.both$p.value)
day_day_ig_ENMO.both <- friedman.test(y = axivity.estimates.both$ENMOig.both, groups = axivity.estimates.both$days.x, blocks = axivity.estimates.both$id)
paste0("Hip * Wrist ENMO intensity gradient: Chi-square =" , day_day_ig_ENMO.both$statistic, ", p-value = ", day_day_ig_ENMO.both$p.value)
day_day_MAD.both <- friedman.test(y = axivity.estimates.both$MAD.both, groups = axivity.estimates.both$days.x, blocks = axivity.estimates.both$id)
paste0("Hip * Wrist MAD: Chi-square =" , day_day_MAD.both$statistic, ", p-value = ", day_day_MAD.both$p.value)
day_day_ig_MAD.both <- friedman.test(y = axivity.estimates.both$MADig.both, groups = axivity.estimates.both$days.x, blocks = axivity.estimates.both$id)
paste0("Hip * Wrist MAD intensity gradient: Chi-square =" , day_day_ig_MAD.both$statistic, ", p-value = ", day_day_ig_MAD.both$p.value)
rm(day_day_ENMO.hip, day_day_ig_ENMO.hip, day_day_MAD.hip, day_day_ig_MAD.hip,
   day_day_ENMO.wrist, day_day_ig_ENMO.wrist, day_day_MAD.wrist, day_day_ig_MAD.wrist,
   day_day_ENMO.both, day_day_ig_ENMO.both, day_day_MAD.both, day_day_ig_MAD.both)
```

```{r Step 4 MLM app, echo=FALSE}
## Step 4: Day-to-day variability
day_day_PA <- friedman.test(y = valid_data_16h7d$PA, groups = valid_data_16h7d$dag, blocks = valid_data_16h7d$castorID)
paste0("PA: Chi-square =" , day_day_PA$statistic, ", p-value = ", day_day_PA$p.value)
day_day_SB <- friedman.test(y = valid_data_16h7d$SB, groups = valid_data_16h7d$dag, blocks = valid_data_16h7d$castorID)
paste0("SB: Chi-square =" , day_day_SB$statistic, ", p-value = ", day_day_SB$p.value)
day_day_sleep <- friedman.test(y = valid_data_16h7d$sleep, groups = valid_data_16h7d$dag, blocks = valid_data_16h7d$castorID)
paste0("Sleep: Chi-square =" , day_day_sleep$statistic, ", p-value = ", day_day_sleep$p.value)
rm(day_day_PA, day_day_SB, day_day_sleep)
```

# Step 5: Calculate single day intraclass correlation (ICC) (2,1)

```{r Step 5 Axivity, echo=FALSE}
# Run intra-class correlations (ICC). Random consistency models, using single measure, ICC(2,1). Single measure is ICC for single day.
# Hip
ratings.hip  <- reshape(axivity.estimates.hip, idvar = "days", timevar = "id", direction = "wide")
ratings_ENMO.hip_long <- as.data.frame(cbind(axivity.estimates.hip$id, axivity.estimates.hip$days, axivity.estimates.hip$ENMO))
names(ratings_ENMO.hip_long) <- c("id", "days", "ENMO")
ratings_ENMO.hip_long$ENMO <- as.numeric(ratings_ENMO.hip_long$ENMO)
ratings_ENMO.hip  <- reshape(ratings_ENMO.hip_long, idvar = "days", timevar = "id", direction = "wide")
ICC.ENMO.hip <- irr::icc(ratings_ENMO.hip[,-1], model = "twoway", type = "consistency")
ratings_ig_ENMO.hip_long <- as.data.frame(cbind(axivity.estimates.hip$id, axivity.estimates.hip$days, axivity.estimates.hip$ig_ENMO))
names(ratings_ig_ENMO.hip_long) <- c("id", "days", "ENMO")
ratings_ig_ENMO.hip_long$ENMO <- as.numeric(ratings_ig_ENMO.hip_long$ENMO)
ratings_igENMO.hip  <- reshape(ratings_ig_ENMO.hip_long, idvar = "days", timevar = "id", direction = "wide")
ICC.ig_ENMO.hip <- irr::icc(ratings_igENMO.hip[,-1], model = "twoway", type = "consistency")
ratings_MAD.hip_long <- as.data.frame(cbind(axivity.estimates.hip$id, axivity.estimates.hip$days, axivity.estimates.hip$MAD))
names(ratings_MAD.hip_long) <- c("id", "days", "MAD")
ratings_MAD.hip_long$MAD <- as.numeric(ratings_MAD.hip_long$MAD)
ratings_MAD.hip  <- reshape(ratings_MAD.hip_long, idvar = "days", timevar = "id", direction = "wide")
ICC.MAD.hip <- irr::icc(ratings_MAD.hip[,-1], model = "twoway", type = "consistency")
ratings_ig_MAD.hip_long <- as.data.frame(cbind(axivity.estimates.hip$id, axivity.estimates.hip$days, axivity.estimates.hip$ig_MAD))
names(ratings_ig_MAD.hip_long) <- c("id", "days", "MAD")
ratings_ig_MAD.hip_long$MAD <- as.numeric(ratings_ig_MAD.hip_long$MAD)
ratings_ig_MAD.hip  <- reshape(ratings_ig_MAD.hip_long, idvar = "days", timevar = "id", direction = "wide")
ICC.ig_MAD.hip <- irr::icc(ratings_ig_MAD.hip[,-1], model = "twoway", type = "consistency")

paste0("Hip ENMO: ICC =" , ICC.ENMO.hip$value, "[", ICC.ENMO.hip$lbound, ";", ICC.ENMO.hip$ubound, "]")
paste0("Hip ENMO intensity gradient: ICC =" , ICC.ig_ENMO.hip$value, "[", ICC.ig_ENMO.hip$lbound, ";", ICC.ig_ENMO.hip$ubound, "]")
paste0("Hip MAD: ICC =" , ICC.MAD.hip$value, "[", ICC.MAD.hip$lbound, ";", ICC.MAD.hip$ubound, "]")
paste0("Hip MAD intensity gradient: ICC =" , ICC.ig_MAD.hip$value, "[", ICC.ig_MAD.hip$lbound, ";", ICC.ig_MAD.hip$ubound, "]")

ratings.wrist  <- reshape(axivity.estimates.wrist, idvar = "days", timevar = "id", direction = "wide")
ratings_ENMO.wrist_long <- as.data.frame(cbind(axivity.estimates.wrist$id, axivity.estimates.wrist$days, axivity.estimates.wrist$ENMO))
names(ratings_ENMO.wrist_long) <- c("id", "days", "ENMO")
ratings_ENMO.wrist_long$ENMO <- as.numeric(ratings_ENMO.wrist_long$ENMO)
ratings_ENMO.wrist  <- reshape(ratings_ENMO.wrist_long, idvar = "days", timevar = "id", direction = "wide")
ICC.ENMO.wrist <- irr::icc(ratings_ENMO.wrist[,-1], model = "twoway", type = "consistency")
ratings_ig_ENMO.wrist_long <- as.data.frame(cbind(axivity.estimates.wrist$id, axivity.estimates.wrist$days, axivity.estimates.wrist$ig_ENMO))
names(ratings_ig_ENMO.wrist_long) <- c("id", "days", "ENMO")
ratings_ig_ENMO.wrist_long$ENMO <- as.numeric(ratings_ig_ENMO.wrist_long$ENMO)
ratings_igENMO.wrist  <- reshape(ratings_ig_ENMO.wrist_long, idvar = "days", timevar = "id", direction = "wide")
ICC.ig_ENMO.wrist <- irr::icc(ratings_igENMO.wrist[,-1], model = "twoway", type = "consistency")
ratings_MAD.wrist_long <- as.data.frame(cbind(axivity.estimates.wrist$id, axivity.estimates.wrist$days, axivity.estimates.wrist$MAD))
names(ratings_MAD.wrist_long) <- c("id", "days", "MAD")
ratings_MAD.wrist_long$MAD <- as.numeric(ratings_MAD.wrist_long$MAD)
ratings_MAD.wrist  <- reshape(ratings_MAD.wrist_long, idvar = "days", timevar = "id", direction = "wide")
ICC.MAD.wrist <- irr::icc(ratings_MAD.wrist[,-1], model = "twoway", type = "consistency")
ratings_ig_MAD.wrist_long <- as.data.frame(cbind(axivity.estimates.wrist$id, axivity.estimates.wrist$days, axivity.estimates.wrist$ig_MAD))
names(ratings_ig_MAD.wrist_long) <- c("id", "days", "MAD")
ratings_ig_MAD.wrist_long$MAD <- as.numeric(ratings_ig_MAD.wrist_long$MAD)
ratings_ig_MAD.wrist  <- reshape(ratings_ig_MAD.wrist_long, idvar = "days", timevar = "id", direction = "wide")
ICC.ig_MAD.wrist <- irr::icc(ratings_ig_MAD.wrist[,-1], model = "twoway", type = "consistency")

paste0("Wrist ENMO: ICC =" , ICC.ENMO.wrist$value, "[", ICC.ENMO.wrist$lbound, ";", ICC.ENMO.wrist$ubound, "]")
paste0("Wrist ENMO intensity gradient: ICC =" , ICC.ig_ENMO.wrist$value, "[", ICC.ig_ENMO.wrist$lbound, ";", ICC.ig_ENMO.wrist$ubound, "]")
paste0("Wrist MAD: ICC =" , ICC.MAD.wrist$value, "[", ICC.MAD.wrist$lbound, ";", ICC.MAD.wrist$ubound, "]")
paste0("Wrist MAD intensity gradient: ICC =" , ICC.ig_MAD.wrist$value, "[", ICC.ig_MAD.wrist$lbound, ";", ICC.ig_MAD.wrist$ubound, "]")

ratings.both  <- reshape(axivity.estimates.both, idvar = "days.x", timevar = "id", direction = "wide")
ratings_ENMO.both_long <- as.data.frame(cbind(axivity.estimates.both$id, axivity.estimates.both$days.x, axivity.estimates.both$ENMO.both))
names(ratings_ENMO.both_long) <- c("id", "days", "ENMO")
ratings_ENMO.both_long$ENMO <- as.numeric(ratings_ENMO.both_long$ENMO)
ratings_ENMO.both  <- reshape(ratings_ENMO.both_long, idvar = "days", timevar = "id", direction = "wide")
ICC.ENMO.both <- irr::icc(ratings_ENMO.both[,-1], model = "twoway", type = "consistency")
ratings_ig_ENMO.both_long <- as.data.frame(cbind(axivity.estimates.both$id, axivity.estimates.both$days.x, axivity.estimates.both$ENMOig.both))
names(ratings_ig_ENMO.both_long) <- c("id", "days", "ENMO")
ratings_ig_ENMO.both_long$ENMO <- as.numeric(ratings_ig_ENMO.both_long$ENMO)
ratings_igENMO.both  <- reshape(ratings_ig_ENMO.both_long, idvar = "days", timevar = "id", direction = "wide")
ICC.ig_ENMO.both <- irr::icc(ratings_igENMO.both[,-1], model = "twoway", type = "consistency")
ratings_MAD.both_long <- as.data.frame(cbind(axivity.estimates.both$id, axivity.estimates.both$days.x, axivity.estimates.both$MAD.both))
names(ratings_MAD.both_long) <- c("id", "days", "MAD")
ratings_MAD.both_long$MAD <- as.numeric(ratings_MAD.both_long$MAD)
ratings_MAD.both  <- reshape(ratings_MAD.both_long, idvar = "days", timevar = "id", direction = "wide")
ICC.MAD.both <- irr::icc(ratings_MAD.both[,-1], model = "twoway", type = "consistency")
ratings_ig_MAD.both_long <- as.data.frame(cbind(axivity.estimates.both$id, axivity.estimates.both$days.x, axivity.estimates.both$MADig.both))
names(ratings_ig_MAD.both_long) <- c("id", "days", "MAD")
ratings_ig_MAD.both_long$MAD <- as.numeric(ratings_ig_MAD.both_long$MAD)
ratings_ig_MAD.both  <- reshape(ratings_ig_MAD.both_long, idvar = "days", timevar = "id", direction = "wide")
ICC.ig_MAD.both <- irr::icc(ratings_ig_MAD.both[,-1], model = "twoway", type = "consistency")

paste0("Hip * Wrist ENMO: ICC =" , ICC.ENMO.both$value, "[", ICC.ENMO.both$lbound, ";", ICC.ENMO.both$ubound, "]")
paste0("Hip * Wrist ENMO intensity gradient: ICC =" , ICC.ig_ENMO.both$value, "[", ICC.ig_ENMO.both$lbound, ";", ICC.ig_ENMO.both$ubound, "]")
paste0("Hip * Wrist MAD: ICC =" , ICC.MAD.both$value, "[", ICC.MAD.both$lbound, ";", ICC.MAD.both$ubound, "]")
paste0("Hip * Wrist MAD intensity gradient: ICC =" , ICC.ig_MAD.both$value, "[", ICC.ig_MAD.both$lbound, ";", ICC.ig_MAD.both$ubound, "]")

rm(ratings_ENMO.hip, ratings_ENMO.hip_long, ratings_ENMO.wrist, ratings_ENMO.wrist_long, ratings_ENMO.both, ratings_ENMO.both_long, ratings_igENMO.hip, ratings_ig_ENMO.hip_long, ratings_igENMO.wrist, ratings_ig_ENMO.wrist_long, ratings_igENMO.both, ratings_ig_ENMO.both_long, ratings_MAD.hip, ratings_MAD.hip_long, ratings_MAD.wrist, ratings_MAD.wrist_long, ratings_MAD.both, ratings_MAD.both_long, ratings_ig_MAD.hip, ratings_ig_MAD.hip_long, ratings_ig_MAD.wrist, ratings_ig_MAD.wrist_long, ratings_ig_MAD.both, ratings_ig_MAD.both_long, ratings.hip, ratings.wrist, ratings.both)
```

```{r Step 5 Axivity hip milestones groups, echo=FALSE}
ratings.hip.nocrawl  <- reshape(estimates.nocrawl.hip, idvar = "days", timevar = "id", direction = "wide")
ratings_ENMO.hip.nocrawl_long <- as.data.frame(cbind(estimates.nocrawl.hip$id, estimates.nocrawl.hip$days, estimates.nocrawl.hip$ENMO))
names(ratings_ENMO.hip.nocrawl_long) <- c("id", "days", "ENMO")
ratings_ENMO.hip.nocrawl_long$ENMO <- as.numeric(ratings_ENMO.hip.nocrawl_long$ENMO)
ratings_ENMO.hip.nocrawl  <- reshape(ratings_ENMO.hip.nocrawl_long, idvar = "days", timevar = "id", direction = "wide")
ICC.ENMO.hip.nocrawl <- irr::icc(ratings_ENMO.hip.nocrawl[,-1], model = "twoway", type = "consistency")
paste0("Hip ENMO no crawling: ICC =" , ICC.ENMO.hip.nocrawl$value, "[", ICC.ENMO.hip.nocrawl$lbound, ";", ICC.ENMO.hip.nocrawl$ubound, "]")
ratings_igENMO.hip.nocrawl_long <- as.data.frame(cbind(estimates.nocrawl.hip$id, estimates.nocrawl.hip$days, estimates.nocrawl.hip$ig_ENMO))
names(ratings_igENMO.hip.nocrawl_long) <- c("id", "days", "ENMO")
ratings_igENMO.hip.nocrawl_long$ENMO <- as.numeric(ratings_igENMO.hip.nocrawl_long$ENMO)
ratings_igENMO.hip.nocrawl  <- reshape(ratings_igENMO.hip.nocrawl_long, idvar = "days", timevar = "id", direction = "wide")
ICC.igENMO.hip.nocrawl <- irr::icc(ratings_igENMO.hip.nocrawl[,-1], model = "twoway", type = "consistency")
paste0("Hip ENMO intensity gradient no crawling: ICC =" , ICC.igENMO.hip.nocrawl$value, "[", ICC.igENMO.hip.nocrawl$lbound, ";", ICC.igENMO.hip.nocrawl$ubound, "]")
ratings_MAD.hip.nocrawl_long <- as.data.frame(cbind(estimates.nocrawl.hip$id, estimates.nocrawl.hip$days, estimates.nocrawl.hip$MAD))
names(ratings_MAD.hip.nocrawl_long) <- c("id", "days", "MAD")
ratings_MAD.hip.nocrawl_long$MAD <- as.numeric(ratings_MAD.hip.nocrawl_long$MAD)
ratings_MAD.hip.nocrawl  <- reshape(ratings_MAD.hip.nocrawl_long, idvar = "days", timevar = "id", direction = "wide")
ICC.MAD.hip.nocrawl <- irr::icc(ratings_MAD.hip.nocrawl[,-1], model = "twoway", type = "consistency")
paste0("Hip MAD intensity gradient no crawling: ICC =" , ICC.MAD.hip.nocrawl$value, "[", ICC.MAD.hip.nocrawl$lbound, ";", ICC.MAD.hip.nocrawl$ubound, "]")
ratings_igMAD.hip.nocrawl_long <- as.data.frame(cbind(estimates.nocrawl.hip$id, estimates.nocrawl.hip$days, estimates.nocrawl.hip$ig_MAD))
names(ratings_igMAD.hip.nocrawl_long) <- c("id", "days", "MAD")
ratings_igMAD.hip.nocrawl_long$MAD <- as.numeric(ratings_igMAD.hip.nocrawl_long$MAD)
ratings_igMAD.hip.nocrawl  <- reshape(ratings_igMAD.hip.nocrawl_long, idvar = "days", timevar = "id", direction = "wide")
ICC.igMAD.hip.nocrawl <- irr::icc(ratings_igMAD.hip.nocrawl[,-1], model = "twoway", type = "consistency")
paste0("Hip MAD intensity gradient no crawling: ICC =" , ICC.igMAD.hip.nocrawl$value, "[", ICC.igMAD.hip.nocrawl$lbound, ";", ICC.igMAD.hip.nocrawl$ubound, "]")

ratings.hip.crawl  <- reshape(estimates.crawl.hip, idvar = "days", timevar = "id", direction = "wide")
ratings_ENMO.hip.crawl_long <- as.data.frame(cbind(estimates.crawl.hip$id, estimates.crawl.hip$days, estimates.crawl.hip$ENMO))
names(ratings_ENMO.hip.crawl_long) <- c("id", "days", "ENMO")
ratings_ENMO.hip.crawl_long$ENMO <- as.numeric(ratings_ENMO.hip.crawl_long$ENMO)
ratings_ENMO.hip.crawl  <- reshape(ratings_ENMO.hip.crawl_long, idvar = "days", timevar = "id", direction = "wide")
ICC.ENMO.hip.crawl <- irr::icc(ratings_ENMO.hip.crawl[,-1], model = "twoway", type = "consistency")
paste0("Hip ENMO crawling: ICC =" , ICC.ENMO.hip.crawl$value, "[", ICC.ENMO.hip.crawl$lbound, ";", ICC.ENMO.hip.crawl$ubound, "]")
ratings_igENMO.hip.crawl_long <- as.data.frame(cbind(estimates.crawl.hip$id, estimates.crawl.hip$days, estimates.crawl.hip$ig_ENMO))
names(ratings_igENMO.hip.crawl_long) <- c("id", "days", "ENMO")
ratings_igENMO.hip.crawl_long$ENMO <- as.numeric(ratings_igENMO.hip.crawl_long$ENMO)
ratings_igENMO.hip.crawl  <- reshape(ratings_igENMO.hip.crawl_long, idvar = "days", timevar = "id", direction = "wide")
ICC.igENMO.hip.crawl <- irr::icc(ratings_igENMO.hip.crawl[,-1], model = "twoway", type = "consistency")
paste0("Hip ENMO intensity gradient crawling: ICC =" , ICC.igENMO.hip.crawl$value, "[", ICC.igENMO.hip.crawl$lbound, ";", ICC.igENMO.hip.crawl$ubound, "]")
ratings_MAD.hip.crawl_long <- as.data.frame(cbind(estimates.crawl.hip$id, estimates.crawl.hip$days, estimates.crawl.hip$MAD))
names(ratings_MAD.hip.crawl_long) <- c("id", "days", "MAD")
ratings_MAD.hip.crawl_long$MAD <- as.numeric(ratings_MAD.hip.crawl_long$MAD)
ratings_MAD.hip.crawl  <- reshape(ratings_MAD.hip.crawl_long, idvar = "days", timevar = "id", direction = "wide")
ICC.MAD.hip.crawl <- irr::icc(ratings_MAD.hip.crawl[,-1], model = "twoway", type = "consistency")
paste0("Hip MAD crawling: ICC =" , ICC.MAD.hip.crawl$value, "[", ICC.MAD.hip.crawl$lbound, ";", ICC.MAD.hip.crawl$ubound, "]")
ratings_igMAD.hip.crawl_long <- as.data.frame(cbind(estimates.crawl.hip$id, estimates.crawl.hip$days, estimates.crawl.hip$ig_MAD))
names(ratings_igMAD.hip.crawl_long) <- c("id", "days", "MAD")
ratings_igMAD.hip.crawl_long$MAD <- as.numeric(ratings_igMAD.hip.crawl_long$MAD)
ratings_igMAD.hip.crawl  <- reshape(ratings_igMAD.hip.crawl_long, idvar = "days", timevar = "id", direction = "wide")
ICC.igMAD.hip.crawl <- irr::icc(ratings_igMAD.hip.crawl[,-1], model = "twoway", type = "consistency")
paste0("Hip MAD intensity gradient crawling: ICC =" , ICC.igMAD.hip.crawl$value, "[", ICC.igMAD.hip.crawl$lbound, ";", ICC.igMAD.hip.crawl$ubound, "]")

ratings.hip.walk  <- reshape(estimates.walk.hip, idvar = "days", timevar = "id", direction = "wide")
ratings_ENMO.hip.walk_long <- as.data.frame(cbind(estimates.walk.hip$id, estimates.walk.hip$days, estimates.walk.hip$ENMO))
names(ratings_ENMO.hip.walk_long) <- c("id", "days", "ENMO")
ratings_ENMO.hip.walk_long$ENMO <- as.numeric(ratings_ENMO.hip.walk_long$ENMO)
ratings_ENMO.hip.walk  <- reshape(ratings_ENMO.hip.walk_long, idvar = "days", timevar = "id", direction = "wide")
ICC.ENMO.hip.walk <- irr::icc(ratings_ENMO.hip.walk[,-1], model = "twoway", type = "consistency")
paste0("Hip ENMO walking: ICC =" , ICC.ENMO.hip.walk$value, "[", ICC.ENMO.hip.walk$lbound, ";", ICC.ENMO.hip.walk$ubound, "]")
ratings_igENMO.hip.walk_long <- as.data.frame(cbind(estimates.walk.hip$id, estimates.walk.hip$days, estimates.walk.hip$ig_ENMO))
names(ratings_igENMO.hip.walk_long) <- c("id", "days", "ENMO")
ratings_igENMO.hip.walk_long$ENMO <- as.numeric(ratings_igENMO.hip.walk_long$ENMO)
ratings_igENMO.hip.walk  <- reshape(ratings_igENMO.hip.walk_long, idvar = "days", timevar = "id", direction = "wide")
ICC.igENMO.hip.walk <- irr::icc(ratings_igENMO.hip.walk[,-1], model = "twoway", type = "consistency")
paste0("Hip ENMO intensity gradient walking: ICC =" , ICC.igENMO.hip.walk$value, "[", ICC.igENMO.hip.walk$lbound, ";", ICC.igENMO.hip.walk$ubound, "]")
ratings_MAD.hip.walk_long <- as.data.frame(cbind(estimates.walk.hip$id, estimates.walk.hip$days, estimates.walk.hip$MAD))
names(ratings_MAD.hip.walk_long) <- c("id", "days", "MAD")
ratings_MAD.hip.walk_long$MAD <- as.numeric(ratings_MAD.hip.walk_long$MAD)
ratings_MAD.hip.walk  <- reshape(ratings_MAD.hip.walk_long, idvar = "days", timevar = "id", direction = "wide")
ICC.MAD.hip.walk <- irr::icc(ratings_MAD.hip.walk[,-1], model = "twoway", type = "consistency")
paste0("Hip MAD walking: ICC =" , ICC.MAD.hip.walk$value, "[", ICC.MAD.hip.walk$lbound, ";", ICC.MAD.hip.walk$ubound, "]")
ratings_igMAD.hip.walk_long <- as.data.frame(cbind(estimates.walk.hip$id, estimates.walk.hip$days, estimates.walk.hip$ig_MAD))
names(ratings_igMAD.hip.walk_long) <- c("id", "days", "MAD")
ratings_igMAD.hip.walk_long$MAD <- as.numeric(ratings_igMAD.hip.walk_long$MAD)
ratings_igMAD.hip.walk  <- reshape(ratings_igMAD.hip.walk_long, idvar = "days", timevar = "id", direction = "wide")
ICC.igMAD.hip.walk <- irr::icc(ratings_igMAD.hip.walk[,-1], model = "twoway", type = "consistency")
paste0("Hip MAD intensity gradient walking: ICC =" , ICC.igMAD.hip.walk$value, "[", ICC.igMAD.hip.walk$lbound, ";", ICC.igMAD.hip.walk$ubound, "]")

rm(ratings_ENMO.hip.walk, ratings_ENMO.hip.walk_long, ratings_ENMO.hip.nocrawl, ratings_ENMO.hip.nocrawl_long, ratings_ENMO.hip.crawl, ratings_ENMO.hip.crawl_long, ratings_igENMO.hip.walk, ratings_igENMO.hip.walk_long, ratings_igENMO.hip.nocrawl, ratings_igENMO.hip.nocrawl_long, ratings_igENMO.hip.crawl, ratings_igENMO.hip.crawl_long, ratings_MAD.hip.walk, ratings_MAD.hip.walk_long, ratings_MAD.hip.nocrawl, ratings_MAD.hip.nocrawl_long, ratings_MAD.hip.crawl, ratings_MAD.hip.crawl_long, ratings_igMAD.hip.walk, ratings_igMAD.hip.walk_long, ratings_igMAD.hip.nocrawl, ratings_igMAD.hip.nocrawl_long, ratings_igMAD.hip.crawl, ratings_igMAD.hip.crawl_long)
```

```{r Step 5 Axivity wrist milestones groups, echo=FALSE}
ratings.wrist.nocrawl  <- reshape(estimates.nocrawl.wrist, idvar = "days", timevar = "id", direction = "wide")
ratings_ENMO.wrist.nocrawl_long <- as.data.frame(cbind(estimates.nocrawl.wrist$id, estimates.nocrawl.wrist$days, estimates.nocrawl.wrist$ENMO))
names(ratings_ENMO.wrist.nocrawl_long) <- c("id", "days", "ENMO")
ratings_ENMO.wrist.nocrawl_long$ENMO <- as.numeric(ratings_ENMO.wrist.nocrawl_long$ENMO)
ratings_ENMO.wrist.nocrawl  <- reshape(ratings_ENMO.wrist.nocrawl_long, idvar = "days", timevar = "id", direction = "wide")
ICC.ENMO.wrist.nocrawl <- irr::icc(ratings_ENMO.wrist.nocrawl[,-1], model = "twoway", type = "consistency")
paste0("wrist ENMO no crawling: ICC =" , ICC.ENMO.wrist.nocrawl$value, "[", ICC.ENMO.wrist.nocrawl$lbound, ";", ICC.ENMO.wrist.nocrawl$ubound, "]")
ratings_igENMO.wrist.nocrawl_long <- as.data.frame(cbind(estimates.nocrawl.wrist$id, estimates.nocrawl.wrist$days, estimates.nocrawl.wrist$ig_ENMO))
names(ratings_igENMO.wrist.nocrawl_long) <- c("id", "days", "ENMO")
ratings_igENMO.wrist.nocrawl_long$ENMO <- as.numeric(ratings_igENMO.wrist.nocrawl_long$ENMO)
ratings_igENMO.wrist.nocrawl  <- reshape(ratings_igENMO.wrist.nocrawl_long, idvar = "days", timevar = "id", direction = "wide")
ICC.igENMO.wrist.nocrawl <- irr::icc(ratings_igENMO.wrist.nocrawl[,-1], model = "twoway", type = "consistency")
paste0("wrist ENMO intensity gradient no crawling: ICC =" , ICC.igENMO.wrist.nocrawl$value, "[", ICC.igENMO.wrist.nocrawl$lbound, ";", ICC.igENMO.wrist.nocrawl$ubound, "]")
ratings_MAD.wrist.nocrawl_long <- as.data.frame(cbind(estimates.nocrawl.wrist$id, estimates.nocrawl.wrist$days, estimates.nocrawl.wrist$MAD))
names(ratings_MAD.wrist.nocrawl_long) <- c("id", "days", "MAD")
ratings_MAD.wrist.nocrawl_long$MAD <- as.numeric(ratings_MAD.wrist.nocrawl_long$MAD)
ratings_MAD.wrist.nocrawl  <- reshape(ratings_MAD.wrist.nocrawl_long, idvar = "days", timevar = "id", direction = "wide")
ICC.MAD.wrist.nocrawl <- irr::icc(ratings_MAD.wrist.nocrawl[,-1], model = "twoway", type = "consistency")
paste0("wrist MAD intensity gradient no crawling: ICC =" , ICC.MAD.wrist.nocrawl$value, "[", ICC.MAD.wrist.nocrawl$lbound, ";", ICC.MAD.wrist.nocrawl$ubound, "]")
ratings_igMAD.wrist.nocrawl_long <- as.data.frame(cbind(estimates.nocrawl.wrist$id, estimates.nocrawl.wrist$days, estimates.nocrawl.wrist$ig_MAD))
names(ratings_igMAD.wrist.nocrawl_long) <- c("id", "days", "MAD")
ratings_igMAD.wrist.nocrawl_long$MAD <- as.numeric(ratings_igMAD.wrist.nocrawl_long$MAD)
ratings_igMAD.wrist.nocrawl  <- reshape(ratings_igMAD.wrist.nocrawl_long, idvar = "days", timevar = "id", direction = "wide")
ICC.igMAD.wrist.nocrawl <- irr::icc(ratings_igMAD.wrist.nocrawl[,-1], model = "twoway", type = "consistency")
paste0("wrist MAD intensity gradient no crawling: ICC =" , ICC.igMAD.wrist.nocrawl$value, "[", ICC.igMAD.wrist.nocrawl$lbound, ";", ICC.igMAD.wrist.nocrawl$ubound, "]")

ratings.wrist.crawl  <- reshape(estimates.crawl.wrist, idvar = "days", timevar = "id", direction = "wide")
ratings_ENMO.wrist.crawl_long <- as.data.frame(cbind(estimates.crawl.wrist$id, estimates.crawl.wrist$days, estimates.crawl.wrist$ENMO))
names(ratings_ENMO.wrist.crawl_long) <- c("id", "days", "ENMO")
ratings_ENMO.wrist.crawl_long$ENMO <- as.numeric(ratings_ENMO.wrist.crawl_long$ENMO)
ratings_ENMO.wrist.crawl  <- reshape(ratings_ENMO.wrist.crawl_long, idvar = "days", timevar = "id", direction = "wide")
ICC.ENMO.wrist.crawl <- irr::icc(ratings_ENMO.wrist.crawl[,-1], model = "twoway", type = "consistency")
paste0("wrist ENMO crawling: ICC =" , ICC.ENMO.wrist.crawl$value, "[", ICC.ENMO.wrist.crawl$lbound, ";", ICC.ENMO.wrist.crawl$ubound, "]")
ratings_igENMO.wrist.crawl_long <- as.data.frame(cbind(estimates.crawl.wrist$id, estimates.crawl.wrist$days, estimates.crawl.wrist$ig_ENMO))
names(ratings_igENMO.wrist.crawl_long) <- c("id", "days", "ENMO")
ratings_igENMO.wrist.crawl_long$ENMO <- as.numeric(ratings_igENMO.wrist.crawl_long$ENMO)
ratings_igENMO.wrist.crawl  <- reshape(ratings_igENMO.wrist.crawl_long, idvar = "days", timevar = "id", direction = "wide")
ICC.igENMO.wrist.crawl <- irr::icc(ratings_igENMO.wrist.crawl[,-1], model = "twoway", type = "consistency")
paste0("wrist ENMO intensity gradient crawling: ICC =" , ICC.igENMO.wrist.crawl$value, "[", ICC.igENMO.wrist.crawl$lbound, ";", ICC.igENMO.wrist.crawl$ubound, "]")
ratings_MAD.wrist.crawl_long <- as.data.frame(cbind(estimates.crawl.wrist$id, estimates.crawl.wrist$days, estimates.crawl.wrist$MAD))
names(ratings_MAD.wrist.crawl_long) <- c("id", "days", "MAD")
ratings_MAD.wrist.crawl_long$MAD <- as.numeric(ratings_MAD.wrist.crawl_long$MAD)
ratings_MAD.wrist.crawl  <- reshape(ratings_MAD.wrist.crawl_long, idvar = "days", timevar = "id", direction = "wide")
ICC.MAD.wrist.crawl <- irr::icc(ratings_MAD.wrist.crawl[,-1], model = "twoway", type = "consistency")
paste0("wrist MAD crawling: ICC =" , ICC.MAD.wrist.crawl$value, "[", ICC.MAD.wrist.crawl$lbound, ";", ICC.MAD.wrist.crawl$ubound, "]")
ratings_igMAD.wrist.crawl_long <- as.data.frame(cbind(estimates.crawl.wrist$id, estimates.crawl.wrist$days, estimates.crawl.wrist$ig_MAD))
names(ratings_igMAD.wrist.crawl_long) <- c("id", "days", "MAD")
ratings_igMAD.wrist.crawl_long$MAD <- as.numeric(ratings_igMAD.wrist.crawl_long$MAD)
ratings_igMAD.wrist.crawl  <- reshape(ratings_igMAD.wrist.crawl_long, idvar = "days", timevar = "id", direction = "wide")
ICC.igMAD.wrist.crawl <- irr::icc(ratings_igMAD.wrist.crawl[,-1], model = "twoway", type = "consistency")
paste0("wrist MAD intensity gradient crawling: ICC =" , ICC.igMAD.wrist.crawl$value, "[", ICC.igMAD.wrist.crawl$lbound, ";", ICC.igMAD.wrist.crawl$ubound, "]")

ratings.wrist.walk  <- reshape(estimates.walk.wrist, idvar = "days", timevar = "id", direction = "wide")
ratings_ENMO.wrist.walk_long <- as.data.frame(cbind(estimates.walk.wrist$id, estimates.walk.wrist$days, estimates.walk.wrist$ENMO))
names(ratings_ENMO.wrist.walk_long) <- c("id", "days", "ENMO")
ratings_ENMO.wrist.walk_long$ENMO <- as.numeric(ratings_ENMO.wrist.walk_long$ENMO)
ratings_ENMO.wrist.walk  <- reshape(ratings_ENMO.wrist.walk_long, idvar = "days", timevar = "id", direction = "wide")
ICC.ENMO.wrist.walk <- irr::icc(ratings_ENMO.wrist.walk[,-1], model = "twoway", type = "consistency")
paste0("wrist ENMO walking: ICC =" , ICC.ENMO.wrist.walk$value, "[", ICC.ENMO.wrist.walk$lbound, ";", ICC.ENMO.wrist.walk$ubound, "]")
ratings_igENMO.wrist.walk_long <- as.data.frame(cbind(estimates.walk.wrist$id, estimates.walk.wrist$days, estimates.walk.wrist$ig_ENMO))
names(ratings_igENMO.wrist.walk_long) <- c("id", "days", "ENMO")
ratings_igENMO.wrist.walk_long$ENMO <- as.numeric(ratings_igENMO.wrist.walk_long$ENMO)
ratings_igENMO.wrist.walk  <- reshape(ratings_igENMO.wrist.walk_long, idvar = "days", timevar = "id", direction = "wide")
ICC.igENMO.wrist.walk <- irr::icc(ratings_igENMO.wrist.walk[,-1], model = "twoway", type = "consistency")
paste0("wrist ENMO intensity gradient walking: ICC =" , ICC.igENMO.wrist.walk$value, "[", ICC.igENMO.wrist.walk$lbound, ";", ICC.igENMO.wrist.walk$ubound, "]")
ratings_MAD.wrist.walk_long <- as.data.frame(cbind(estimates.walk.wrist$id, estimates.walk.wrist$days, estimates.walk.wrist$MAD))
names(ratings_MAD.wrist.walk_long) <- c("id", "days", "MAD")
ratings_MAD.wrist.walk_long$MAD <- as.numeric(ratings_MAD.wrist.walk_long$MAD)
ratings_MAD.wrist.walk  <- reshape(ratings_MAD.wrist.walk_long, idvar = "days", timevar = "id", direction = "wide")
ICC.MAD.wrist.walk <- irr::icc(ratings_MAD.wrist.walk[,-1], model = "twoway", type = "consistency")
paste0("wrist MAD walking: ICC =" , ICC.MAD.wrist.walk$value, "[", ICC.MAD.wrist.walk$lbound, ";", ICC.MAD.wrist.walk$ubound, "]")
ratings_igMAD.wrist.walk_long <- as.data.frame(cbind(estimates.walk.wrist$id, estimates.walk.wrist$days, estimates.walk.wrist$ig_MAD))
names(ratings_igMAD.wrist.walk_long) <- c("id", "days", "MAD")
ratings_igMAD.wrist.walk_long$MAD <- as.numeric(ratings_igMAD.wrist.walk_long$MAD)
ratings_igMAD.wrist.walk  <- reshape(ratings_igMAD.wrist.walk_long, idvar = "days", timevar = "id", direction = "wide")
ICC.igMAD.wrist.walk <- irr::icc(ratings_igMAD.wrist.walk[,-1], model = "twoway", type = "consistency")
paste0("wrist MAD intensity gradient walking: ICC =" , ICC.igMAD.wrist.walk$value, "[", ICC.igMAD.wrist.walk$lbound, ";", ICC.igMAD.wrist.walk$ubound, "]")

rm(ratings_ENMO.wrist.walk, ratings_ENMO.wrist.walk_long, ratings_ENMO.wrist.nocrawl, ratings_ENMO.wrist.nocrawl_long, ratings_ENMO.wrist.crawl, ratings_ENMO.wrist.crawl_long, ratings_igENMO.wrist.walk, ratings_igENMO.wrist.walk_long, ratings_igENMO.wrist.nocrawl, ratings_igENMO.wrist.nocrawl_long, ratings_igENMO.wrist.crawl, ratings_igENMO.wrist.crawl_long, ratings_MAD.wrist.walk, ratings_MAD.wrist.walk_long, ratings_MAD.wrist.nocrawl, ratings_MAD.wrist.nocrawl_long, ratings_MAD.wrist.crawl, ratings_MAD.wrist.crawl_long, ratings_igMAD.wrist.walk, ratings_igMAD.wrist.walk_long, ratings_igMAD.wrist.nocrawl, ratings_igMAD.wrist.nocrawl_long, ratings_igMAD.wrist.crawl, ratings_igMAD.wrist.crawl_long)
```

```{r Step 5 Axivity hip * wrist milestones groups, echo=FALSE}
ratings.both.nocrawl  <- reshape(estimates.nocrawl.both, idvar = "days", timevar = "id", direction = "wide")
ratings_ENMO.both.nocrawl_long <- as.data.frame(cbind(estimates.nocrawl.both$id, estimates.nocrawl.both$days, estimates.nocrawl.both$ENMO.both))
names(ratings_ENMO.both.nocrawl_long) <- c("id", "days", "ENMO")
ratings_ENMO.both.nocrawl_long$ENMO <- as.numeric(ratings_ENMO.both.nocrawl_long$ENMO)
ratings_ENMO.both.nocrawl  <- reshape(ratings_ENMO.both.nocrawl_long, idvar = "days", timevar = "id", direction = "wide")
ICC.ENMO.both.nocrawl <- irr::icc(ratings_ENMO.both.nocrawl[,-1], model = "twoway", type = "consistency")
paste0("Hip * wrist ENMO no crawling: ICC =" , ICC.ENMO.both.nocrawl$value, "[", ICC.ENMO.both.nocrawl$lbound, ";", ICC.ENMO.both.nocrawl$ubound, "]")
ratings_igENMO.both.nocrawl_long <- as.data.frame(cbind(estimates.nocrawl.both$id, estimates.nocrawl.both$days, estimates.nocrawl.both$ig_ENMO.both))
names(ratings_igENMO.both.nocrawl_long) <- c("id", "days", "ENMO")
ratings_igENMO.both.nocrawl_long$ENMO <- as.numeric(ratings_igENMO.both.nocrawl_long$ENMO)
ratings_igENMO.both.nocrawl  <- reshape(ratings_igENMO.both.nocrawl_long, idvar = "days", timevar = "id", direction = "wide")
ICC.igENMO.both.nocrawl <- irr::icc(ratings_igENMO.both.nocrawl[,-1], model = "twoway", type = "consistency")
paste0("Hip * wrist ENMO intensity gradient no crawling: ICC =" , ICC.igENMO.both.nocrawl$value, "[", ICC.igENMO.both.nocrawl$lbound, ";", ICC.igENMO.both.nocrawl$ubound, "]")
ratings_MAD.both.nocrawl_long <- as.data.frame(cbind(estimates.nocrawl.both$id, estimates.nocrawl.both$days, estimates.nocrawl.both$MAD.both))
names(ratings_MAD.both.nocrawl_long) <- c("id", "days", "MAD")
ratings_MAD.both.nocrawl_long$MAD <- as.numeric(ratings_MAD.both.nocrawl_long$MAD)
ratings_MAD.both.nocrawl  <- reshape(ratings_MAD.both.nocrawl_long, idvar = "days", timevar = "id", direction = "wide")
ICC.MAD.both.nocrawl <- irr::icc(ratings_MAD.both.nocrawl[,-1], model = "twoway", type = "consistency")
paste0("Hip * wrist MAD intensity gradient no crawling: ICC =" , ICC.MAD.both.nocrawl$value, "[", ICC.MAD.both.nocrawl$lbound, ";", ICC.MAD.both.nocrawl$ubound, "]")
ratings_igMAD.both.nocrawl_long <- as.data.frame(cbind(estimates.nocrawl.both$id, estimates.nocrawl.both$days, estimates.nocrawl.both$ig_MAD.both))
names(ratings_igMAD.both.nocrawl_long) <- c("id", "days", "MAD")
ratings_igMAD.both.nocrawl_long$MAD <- as.numeric(ratings_igMAD.both.nocrawl_long$MAD)
ratings_igMAD.both.nocrawl  <- reshape(ratings_igMAD.both.nocrawl_long, idvar = "days", timevar = "id", direction = "wide")
ICC.igMAD.both.nocrawl <- irr::icc(ratings_igMAD.both.nocrawl[,-1], model = "twoway", type = "consistency")
paste0("Hip * wrist MAD intensity gradient no crawling: ICC =" , ICC.igMAD.both.nocrawl$value, "[", ICC.igMAD.both.nocrawl$lbound, ";", ICC.igMAD.both.nocrawl$ubound, "]")

ratings.both.crawl  <- reshape(estimates.crawl.both, idvar = "days", timevar = "id", direction = "wide")
ratings_ENMO.both.crawl_long <- as.data.frame(cbind(estimates.crawl.both$id, estimates.crawl.both$days, estimates.crawl.both$ENMO.both))
names(ratings_ENMO.both.crawl_long) <- c("id", "days", "ENMO")
ratings_ENMO.both.crawl_long$ENMO <- as.numeric(ratings_ENMO.both.crawl_long$ENMO)
ratings_ENMO.both.crawl  <- reshape(ratings_ENMO.both.crawl_long, idvar = "days", timevar = "id", direction = "wide")
ICC.ENMO.both.crawl <- irr::icc(ratings_ENMO.both.crawl[,-1], model = "twoway", type = "consistency")
paste0("Hip * wrist ENMO crawling: ICC =" , ICC.ENMO.both.crawl$value, "[", ICC.ENMO.both.crawl$lbound, ";", ICC.ENMO.both.crawl$ubound, "]")
ratings_igENMO.both.crawl_long <- as.data.frame(cbind(estimates.crawl.both$id, estimates.crawl.both$days, estimates.crawl.both$ig_ENMO.both))
names(ratings_igENMO.both.crawl_long) <- c("id", "days", "ENMO")
ratings_igENMO.both.crawl_long$ENMO <- as.numeric(ratings_igENMO.both.crawl_long$ENMO)
ratings_igENMO.both.crawl  <- reshape(ratings_igENMO.both.crawl_long, idvar = "days", timevar = "id", direction = "wide")
ICC.igENMO.both.crawl <- irr::icc(ratings_igENMO.both.crawl[,-1], model = "twoway", type = "consistency")
paste0("Hip * wrist ENMO intensity gradient crawling: ICC =" , ICC.igENMO.both.crawl$value, "[", ICC.igENMO.both.crawl$lbound, ";", ICC.igENMO.both.crawl$ubound, "]")
ratings_MAD.both.crawl_long <- as.data.frame(cbind(estimates.crawl.both$id, estimates.crawl.both$days, estimates.crawl.both$MAD.both))
names(ratings_MAD.both.crawl_long) <- c("id", "days", "MAD")
ratings_MAD.both.crawl_long$MAD <- as.numeric(ratings_MAD.both.crawl_long$MAD)
ratings_MAD.both.crawl  <- reshape(ratings_MAD.both.crawl_long, idvar = "days", timevar = "id", direction = "wide")
ICC.MAD.both.crawl <- irr::icc(ratings_MAD.both.crawl[,-1], model = "twoway", type = "consistency")
paste0("Hip * wrist MAD crawling: ICC =" , ICC.MAD.both.crawl$value, "[", ICC.MAD.both.crawl$lbound, ";", ICC.MAD.both.crawl$ubound, "]")
ratings_igMAD.both.crawl_long <- as.data.frame(cbind(estimates.crawl.both$id, estimates.crawl.both$days, estimates.crawl.both$ig_MAD.both))
names(ratings_igMAD.both.crawl_long) <- c("id", "days", "MAD")
ratings_igMAD.both.crawl_long$MAD <- as.numeric(ratings_igMAD.both.crawl_long$MAD)
ratings_igMAD.both.crawl  <- reshape(ratings_igMAD.both.crawl_long, idvar = "days", timevar = "id", direction = "wide")
ICC.igMAD.both.crawl <- irr::icc(ratings_igMAD.both.crawl[,-1], model = "twoway", type = "consistency")
paste0("Hip * wrist MAD intensity gradient crawling: ICC =" , ICC.igMAD.both.crawl$value, "[", ICC.igMAD.both.crawl$lbound, ";", ICC.igMAD.both.crawl$ubound, "]")

ratings.both.walk  <- reshape(estimates.walk.both, idvar = "days", timevar = "id", direction = "wide")
ratings_ENMO.both.walk_long <- as.data.frame(cbind(estimates.walk.both$id, estimates.walk.both$days, estimates.walk.both$ENMO.both))
names(ratings_ENMO.both.walk_long) <- c("id", "days", "ENMO")
ratings_ENMO.both.walk_long$ENMO <- as.numeric(ratings_ENMO.both.walk_long$ENMO)
ratings_ENMO.both.walk  <- reshape(ratings_ENMO.both.walk_long, idvar = "days", timevar = "id", direction = "wide")
ICC.ENMO.both.walk <- irr::icc(ratings_ENMO.both.walk[,-1], model = "twoway", type = "consistency")
paste0("Hip * wrist ENMO walking: ICC =" , ICC.ENMO.both.walk$value, "[", ICC.ENMO.both.walk$lbound, ";", ICC.ENMO.both.walk$ubound, "]")
ratings_igENMO.both.walk_long <- as.data.frame(cbind(estimates.walk.both$id, estimates.walk.both$days, estimates.walk.both$ig_ENMO.both))
names(ratings_igENMO.both.walk_long) <- c("id", "days", "ENMO")
ratings_igENMO.both.walk_long$ENMO <- as.numeric(ratings_igENMO.both.walk_long$ENMO)
ratings_igENMO.both.walk  <- reshape(ratings_igENMO.both.walk_long, idvar = "days", timevar = "id", direction = "wide")
ICC.igENMO.both.walk <- irr::icc(ratings_igENMO.both.walk[,-1], model = "twoway", type = "consistency")
paste0("Hip * wrist ENMO intensity gradient walking: ICC =" , ICC.igENMO.both.walk$value, "[", ICC.igENMO.both.walk$lbound, ";", ICC.igENMO.both.walk$ubound, "]")
ratings_MAD.both.walk_long <- as.data.frame(cbind(estimates.walk.both$id, estimates.walk.both$days, estimates.walk.both$MAD.both))
names(ratings_MAD.both.walk_long) <- c("id", "days", "MAD")
ratings_MAD.both.walk_long$MAD <- as.numeric(ratings_MAD.both.walk_long$MAD)
ratings_MAD.both.walk  <- reshape(ratings_MAD.both.walk_long, idvar = "days", timevar = "id", direction = "wide")
ICC.MAD.both.walk <- irr::icc(ratings_MAD.both.walk[,-1], model = "twoway", type = "consistency")
paste0("Hip * wrist MAD walking: ICC =" , ICC.MAD.both.walk$value, "[", ICC.MAD.both.walk$lbound, ";", ICC.MAD.both.walk$ubound, "]")
ratings_igMAD.both.walk_long <- as.data.frame(cbind(estimates.walk.both$id, estimates.walk.both$days, estimates.walk.both$ig_MAD.both))
names(ratings_igMAD.both.walk_long) <- c("id", "days", "MAD")
ratings_igMAD.both.walk_long$MAD <- as.numeric(ratings_igMAD.both.walk_long$MAD)
ratings_igMAD.both.walk  <- reshape(ratings_igMAD.both.walk_long, idvar = "days", timevar = "id", direction = "wide")
ICC.igMAD.both.walk <- irr::icc(ratings_igMAD.both.walk[,-1], model = "twoway", type = "consistency")
paste0("Hip * wrist MAD intensity gradient walking: ICC =" , ICC.igMAD.both.walk$value, "[", ICC.igMAD.both.walk$lbound, ";", ICC.igMAD.both.walk$ubound, "]")

rm(ratings_ENMO.both.walk, ratings_ENMO.both.walk_long, ratings_ENMO.both.nocrawl, ratings_ENMO.both.nocrawl_long, ratings_ENMO.both.crawl, ratings_ENMO.both.crawl_long, ratings_igENMO.both.walk, ratings_igENMO.both.walk_long, ratings_igENMO.both.nocrawl, ratings_igENMO.both.nocrawl_long, ratings_igENMO.both.crawl, ratings_igENMO.both.crawl_long, ratings_MAD.both.walk, ratings_MAD.both.walk_long, ratings_MAD.both.nocrawl, ratings_MAD.both.nocrawl_long, ratings_MAD.both.crawl, ratings_MAD.both.crawl_long, ratings_igMAD.both.walk, ratings_igMAD.both.walk_long, ratings_igMAD.both.nocrawl, ratings_igMAD.both.nocrawl_long, ratings_igMAD.both.crawl, ratings_igMAD.both.crawl_long)
```

```{r Step 5 MLM pp, echo=FALSE}
# Run intra-class correlations (ICC). Random consistency models, using single measure, ICC(2,1). Single measure is ICC for single day.
ratings_PA_long <- as.data.frame(cbind(valid_data_16h7d$castorID, valid_data_16h7d$dag, valid_data_16h7d$PA))
names(ratings_PA_long) <- c("id", "days", "PA")
ratings_PA_long$PA <- as.numeric(ratings_PA_long$PA)
ratings_PA_long$days <- as.factor(ratings_PA_long$days)
ratings_PA_long$id <- as.factor(ratings_PA_long$id)
ratings_PA  <- reshape(ratings_PA_long, idvar = "id", timevar = "days", direction = "wide")

ratings_SB_long <- as.data.frame(cbind(valid_data_16h7d$castorID, valid_data_16h7d$dag, valid_data_16h7d$SB))
names(ratings_SB_long) <- c("id", "days", "SB")
ratings_SB_long$SB <- as.numeric(ratings_SB_long$SB)
ratings_SB_long$days <- as.factor(ratings_SB_long$days)
ratings_SB_long$id <- as.factor(ratings_SB_long$id)
ratings_SB  <- reshape(ratings_SB_long, idvar = "id", timevar = "days", direction = "wide")

ratings_sleep_long <- as.data.frame(cbind(valid_data_16h7d$castorID, valid_data_16h7d$dag, valid_data_16h7d$sleep))
names(ratings_sleep_long) <- c("id", "days", "sleep")
ratings_sleep_long$sleep <- as.numeric(ratings_sleep_long$sleep)
ratings_sleep_long$days <- as.factor(ratings_sleep_long$days)
ratings_sleep_long$id <- as.factor(ratings_sleep_long$id)
ratings_sleep  <- reshape(ratings_sleep_long, idvar = "id", timevar = "days", direction = "wide")

ICC.PA <- irr::icc(ratings_PA[,-1], model = "twoway", type = "consistency")
paste0("PA: ICC =" , ICC.PA$value, "[", ICC.PA$lbound, ";", ICC.PA$ubound, "]")
ICC.SB <- irr::icc(ratings_SB[,-1], model = "twoway", type = "consistency")
paste0("SB: ICC =" , ICC.SB$value, "[", ICC.SB$lbound, ";", ICC.SB$ubound, "]")
ICC.sleep <- irr::icc(ratings_sleep[,-1], model = "twoway", type = "consistency")
paste0("Sleep: ICC =" , ICC.sleep$value, "[", ICC.sleep$lbound, ";", ICC.sleep$ubound, "]")
rm(valid_data_16h7d, ratings_PA_long, ratings_PA, ratings_SB_long, ratings_SB, ratings_sleep_long, ratings_sleep)
```

# Step 6: Calculate number of days required to reach reliability

```{r Step 6 Axivity, echo=FALSE}
# Run the Spearman-Brown prophecy formula inputting single day ICC’s for each outcome and defining
print("Results hip:")
print("To reach 0.7, 0.75, and 0.8 reliability ENMO: ")
spearman.brown(singleICC = ICC.ENMO.hip$value, desiredR = 0.7)
spearman.brown(singleICC = ICC.ENMO.hip$value, desiredR = 0.75)
spearman.brown(singleICC = ICC.ENMO.hip$value, desiredR = 0.8)
print("To reach 0.7, 0.75, and 0.8 reliability ENMO intensity gradient: ")
spearman.brown(singleICC = ICC.ig_ENMO.hip$value, desiredR = 0.7)
spearman.brown(singleICC = ICC.ig_ENMO.hip$value, desiredR = 0.75)
spearman.brown(singleICC = ICC.ig_ENMO.hip$value, desiredR = 0.8)
print("To reach 0.7, 0.75, and 0.8 reliability MAD: ")
spearman.brown(singleICC = ICC.MAD.hip$value, desiredR = 0.7)
spearman.brown(singleICC = ICC.MAD.hip$value, desiredR = 0.75)
spearman.brown(singleICC = ICC.MAD.hip$value, desiredR = 0.8)
print("To reach 0.7, 0.75, and 0.8 reliability MAD intensity gradient: ")
spearman.brown(singleICC = ICC.ig_MAD.hip$value, desiredR = 0.7)
spearman.brown(singleICC = ICC.ig_MAD.hip$value, desiredR = 0.75)
spearman.brown(singleICC = ICC.ig_MAD.hip$value, desiredR = 0.8)

print("Results wrist:")
print("To reach 0.7, 0.75, and 0.8 reliability ENMO: ")
spearman.brown(singleICC = ICC.ENMO.wrist$value, desiredR = 0.7)
spearman.brown(singleICC = ICC.ENMO.wrist$value, desiredR = 0.75)
spearman.brown(singleICC = ICC.ENMO.wrist$value, desiredR = 0.8)
print("To reach 0.7, 0.75, and 0.8 reliability ENMO intensity gradient: ")
spearman.brown(singleICC = ICC.ig_ENMO.wrist$value, desiredR = 0.7)
spearman.brown(singleICC = ICC.ig_ENMO.wrist$value, desiredR = 0.75)
spearman.brown(singleICC = ICC.ig_ENMO.wrist$value, desiredR = 0.8)
print("To reach 0.7, 0.75, and 0.8 reliability MAD: ")
spearman.brown(singleICC = ICC.MAD.wrist$value, desiredR = 0.7)
spearman.brown(singleICC = ICC.MAD.wrist$value, desiredR = 0.75)
spearman.brown(singleICC = ICC.MAD.wrist$value, desiredR = 0.8)
print("To reach 0.7, 0.75, and 0.8 reliability MAD intensity gradient: ")
spearman.brown(singleICC = ICC.ig_MAD.wrist$value, desiredR = 0.7)
spearman.brown(singleICC = ICC.ig_MAD.wrist$value, desiredR = 0.75)
spearman.brown(singleICC = ICC.ig_MAD.wrist$value, desiredR = 0.8)

print("Results hip*wrist:")
print("To reach 0.7, 0.75, and 0.8 reliability ENMO: ")
spearman.brown(singleICC = ICC.ENMO.both$value, desiredR = 0.7)
spearman.brown(singleICC = ICC.ENMO.both$value, desiredR = 0.75)
spearman.brown(singleICC = ICC.ENMO.both$value, desiredR = 0.8)
print("To reach 0.7, 0.75, and 0.8 reliability ENMO intensity gradient: ")
spearman.brown(singleICC = ICC.ig_ENMO.both$value, desiredR = 0.7)
spearman.brown(singleICC = ICC.ig_ENMO.both$value, desiredR = 0.75)
spearman.brown(singleICC = ICC.ig_ENMO.both$value, desiredR = 0.8)
print("To reach 0.7, 0.75, and 0.8 reliability MAD: ")
spearman.brown(singleICC = ICC.MAD.both$value, desiredR = 0.7)
spearman.brown(singleICC = ICC.MAD.both$value, desiredR = 0.75)
spearman.brown(singleICC = ICC.MAD.both$value, desiredR = 0.8)
print("To reach 0.7, 0.75, and 0.8 reliability MAD intensity gradient: ")
spearman.brown(singleICC = ICC.ig_MAD.both$value, desiredR = 0.7)
spearman.brown(singleICC = ICC.ig_MAD.both$value, desiredR = 0.75)
spearman.brown(singleICC = ICC.ig_MAD.both$value, desiredR = 0.8)
```

```{r Step 6 Axivity hip milestones groups, echo=FALSE}
print("Results not crawling:")
print("To reach 0.7 reliability ENMO: ")
spearman.brown(singleICC = ICC.ENMO.hip.nocrawl$value, desiredR = 0.7)
print("To reach 0.7 reliability intensity gradient ENMO: ")
spearman.brown(singleICC = ICC.igENMO.hip.nocrawl$value, desiredR = 0.7)
print("To reach 0.7 reliability MAD: ")
spearman.brown(singleICC = ICC.MAD.hip.nocrawl$value, desiredR = 0.7)
print("To reach 0.7 reliability intensity gradient MAD: ")
spearman.brown(singleICC = ICC.igMAD.hip.nocrawl$value, desiredR = 0.7)

print("Results crawling:")
print("To reach 0.7 reliability ENMO: ")
spearman.brown(singleICC = ICC.ENMO.hip.crawl$value, desiredR = 0.7)
print("To reach 0.7 reliability intensity gradient ENMO: ")
spearman.brown(singleICC = ICC.igENMO.hip.crawl$value, desiredR = 0.7)
print("To reach 0.7 reliability MAD: ")
spearman.brown(singleICC = ICC.MAD.hip.crawl$value, desiredR = 0.7)
print("To reach 0.7 reliability intensity gradient MAD: ")
spearman.brown(singleICC = ICC.igMAD.hip.crawl$value, desiredR = 0.7)

print("Results walking:")
print("To reach 0.7 reliability ENMO: ")
spearman.brown(singleICC = ICC.ENMO.hip.walk$value, desiredR = 0.7)
print("To reach 0.7 reliability intensity gradient ENMO: ")
spearman.brown(singleICC = ICC.igENMO.hip.walk$value, desiredR = 0.7)
print("To reach 0.7 reliability MAD: ")
spearman.brown(singleICC = ICC.MAD.hip.walk$value, desiredR = 0.7)
print("To reach 0.7 reliability intensity gradient MAD: ")
spearman.brown(singleICC = ICC.igMAD.hip.walk$value, desiredR = 0.7)
```

```{r Step 6 Axivity wrist milestones groups, echo=FALSE}
print("Results not crawling:")
print("To reach 0.7 reliability ENMO: ")
spearman.brown(singleICC = ICC.ENMO.wrist.nocrawl$value, desiredR = 0.7)
print("To reach 0.7 reliability intensity gradient ENMO: ")
spearman.brown(singleICC = ICC.igENMO.wrist.nocrawl$value, desiredR = 0.7)
print("To reach 0.7 reliability MAD: ")
spearman.brown(singleICC = ICC.MAD.wrist.nocrawl$value, desiredR = 0.7)
print("To reach 0.7 reliability intensity gradient MAD: ")
spearman.brown(singleICC = ICC.igMAD.wrist.nocrawl$value, desiredR = 0.7)

print("Results crawling:")
print("To reach 0.7 reliability ENMO: ")
spearman.brown(singleICC = ICC.ENMO.wrist.crawl$value, desiredR = 0.7)
print("To reach 0.7 reliability intensity gradient ENMO: ")
spearman.brown(singleICC = ICC.igENMO.wrist.crawl$value, desiredR = 0.7)
print("To reach 0.7 reliability MAD: ")
spearman.brown(singleICC = ICC.MAD.wrist.crawl$value, desiredR = 0.7)
print("To reach 0.7 reliability intensity gradient MAD: ")
spearman.brown(singleICC = ICC.igMAD.wrist.crawl$value, desiredR = 0.7)

print("Results walking:")
print("To reach 0.7 reliability ENMO: ")
spearman.brown(singleICC = ICC.ENMO.wrist.walk$value, desiredR = 0.7)
print("To reach 0.7 reliability intensity gradient ENMO: ")
spearman.brown(singleICC = ICC.igENMO.wrist.walk$value, desiredR = 0.7)
print("To reach 0.7 reliability MAD: ")
spearman.brown(singleICC = ICC.MAD.wrist.walk$value, desiredR = 0.7)
print("To reach 0.7 reliability intensity gradient MAD: ")
spearman.brown(singleICC = ICC.igMAD.wrist.walk$value, desiredR = 0.7)
```

```{r Step 6 Axivity hip * wrist milestones groups, echo=FALSE}
print("Results not crawling:")
print("To reach 0.7 reliability ENMO: ")
spearman.brown(singleICC = ICC.ENMO.both.nocrawl$value, desiredR = 0.7)
print("To reach 0.7 reliability intensity gradient ENMO: ")
spearman.brown(singleICC = ICC.igENMO.both.nocrawl$value, desiredR = 0.7)
print("To reach 0.7 reliability MAD: ")
spearman.brown(singleICC = ICC.MAD.both.nocrawl$value, desiredR = 0.7)
print("To reach 0.7 reliability intensity gradient MAD: ")
spearman.brown(singleICC = ICC.igMAD.both.nocrawl$value, desiredR = 0.7)

print("Results crawling:")
print("To reach 0.7 reliability ENMO: ")
spearman.brown(singleICC = ICC.ENMO.both.crawl$value, desiredR = 0.7)
print("To reach 0.7 reliability intensity gradient ENMO: ")
spearman.brown(singleICC = ICC.igENMO.both.crawl$value, desiredR = 0.7)
print("To reach 0.7 reliability MAD: ")
spearman.brown(singleICC = ICC.MAD.both.crawl$value, desiredR = 0.7)
print("To reach 0.7 reliability intensity gradient MAD: ")
spearman.brown(singleICC = ICC.igMAD.both.crawl$value, desiredR = 0.7)

print("Results walking:")
print("To reach 0.7 reliability ENMO: ")
spearman.brown(singleICC = ICC.ENMO.both.walk$value, desiredR = 0.7)
print("To reach 0.7 reliability intensity gradient ENMO: ")
spearman.brown(singleICC = ICC.igENMO.both.walk$value, desiredR = 0.7)
print("To reach 0.7 reliability MAD: ")
spearman.brown(singleICC = ICC.MAD.both.walk$value, desiredR = 0.7)
print("To reach 0.7 reliability intensity gradient MAD: ")
spearman.brown(singleICC = ICC.igMAD.both.walk$value, desiredR = 0.7)
```

```{r Step 6 MLM pp, echo=FALSE}
# Run the Spearman-Brown prophecy formula inputting single day ICC’s for each outcome and defining
print("To reach 0.7, 0.75, and 0.8 reliability PA: ")
spearman.brown(singleICC = ICC.PA$value, desiredR = 0.7)
spearman.brown(singleICC = ICC.PA$value, desiredR = 0.75)
spearman.brown(singleICC = ICC.PA$value, desiredR = 0.8)

print("To reach 0.7, 0.75, and 0.8 reliability SB: ")
spearman.brown(singleICC = ICC.SB$value, desiredR = 0.7)
spearman.brown(singleICC = ICC.SB$value, desiredR = 0.75)
spearman.brown(singleICC = ICC.SB$value, desiredR = 0.8)

print("To reach 0.7, 0.75, and 0.8 reliability sleep: ")
spearman.brown(singleICC = ICC.sleep$value, desiredR = 0.7)
spearman.brown(singleICC = ICC.sleep$value, desiredR = 0.75)
spearman.brown(singleICC = ICC.sleep$value, desiredR = 0.8)
```
